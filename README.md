# Find-CsExternalFederatedContacts.ps1

This script iterates though an XML file generated by the Lync 2013 Export-CsUserData cmdlet and produces a HMTL report of external federated domains
For detailed information, see https://www.UcMadScientist.com/Find-CsExternalFederatedContacts/


## Instructions
This script will pull data from an existing DocItemSet.xml from an Export-CsUserData export.
To use it you will need to export your existing user data by running "Export-CsUserData -PoolFQDN "FEPool.UcMadScientist.com" -Filename "Export.zip" from a server in your Lync/Skype enviroment.
Once you have, open the ZIP file and place the DocItemSet.xml in the same folder as this script.
Run the script and it will generate a HTML report with all the domains that users have saved in their contact lists and how frequently they have been found.

## Optional Command Line Parameters

### -DisableScriptUpdate
Stops the script from checking online for an update and prompting the user to download. Ideal for scheduled tasks

### -NoHtml
Stops the script from generating a HTML report, instead, results will be placed in the Pipeline to be picked up by another script or displayed on the screen

### -FullName
Instead of just listing the domains in the contact list, this will list every unique contact stored in every user's Lync/Skype contact list.
Be careful! The output of this setting will contain personal data and should be treated as such.


## Known Issues
Presently the script will also report the local sip domains as well as remote, this is typically the largest count and can be ignored.

Depending on how you export your CsUserData you may get a bunch of weird-looking GUID contacts. These are from your SIP application accounts and can be safely ignored.

There is presently no auto export function, you will need to export the CsUserData yourself

## Fork me!
This script is free, open source and licensed under the MIT Licence. Feel free to view the source, fork it, raise issues and submit your improvements via pull requests. You can find on Github:
https://github.com/Atreidae/


